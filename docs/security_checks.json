{
  "user_owned_device": {
    "name": "Non company device used",
    "description": "Checks for users with company_user true and company_device false.",
    "remediation": "Understand and remediate or document known exception.",
    "severity": 3,
    "resource_scope": ["users"],
    "check_query": [
      "resources[resource][\"company_user\"] and not resources[resource][\"company_device\"]"
    ]
  },
  "broken_access_control": {
    "name": "A01:2021-Broken Access Control",
    "description": "OWASP top 10 #1: Checks for combination of controls that indicate lack of mitigation against this type of attack",
    "remediation": "Review non-compliant controls and remediate",
    "severity": 1,
    "likelihood": 1,
    "resource_scope": [
      "systems",
      "containers"
    ],
    "check_query": [
      "not resources[resource][\"requires_authentication\"] ",
      "or not resources[resource][\"least_privileged_access\"] ",
      "or not resources[resource][\"access_logging_enabled\"] ",
      "or not resources[resource][\"cors_minimal_required_usage\"] ",
      "or not resources[resource][\"stateful_sessions_invalidated\"] "
    ]
  },
  "cryptographic_failures": {
    "name": "A02:2021-Cryptographic_Failures",
    "description": "OWASP top 10 #2: Checks for various items related to encryption",
    "remediation": "Review non-compliant controls and remediate",
    "severity": 1,
    "likelihood": 1,
    "resource_scope": [
      "databases"
    ],
    "check_query": [
      "not resources[resource][\"is_encrypted\"] ",
      "or not resources[resource][\"cleanup_tasks_configured\"] ",
      "or not resources[resource][\"requires_encrypted_connections\"] ",
      "or not resources[resource][\"authentication_required\"] ",
      "or not resources[resource][\"passwords_hashed\"] "
    ]
  },
  "sql_injection": {
    "name": "A03:2021 – Injection",
    "description": "OWASP top 10 #3: Checks for mitigations against SQL injection",
    "remediation": "Review non-compliant controls and remediate",
    "severity": 1,
    "likelihood": 1,
    "resource_scope": [
      "systems",
      "containers"
    ],
    "check_query": [
      "(",
      " not resources[resource][\"input_sanitization\"] ",
      " or not resources[resource][\"authentication_required\"]",
      " or not resources[resource][\"is_hardened\"]",
      ") and resources[resource][\"db_op\"]"
    ]
  },
  "insecure_design": {
    "name": "A04:2021 – Insecure Design",
    "description": "OWASP top 10 #4: Checks for good Software development practices",
    "remediation": "Review non-compliant controls and remediate",
    "severity": 1,
    "likelihood": 1,
    "resource_scope": [
      "systems",
      "containers"
    ],
    "check_query": [
      " not resources[resource][\"dependabot_used\"] ",
      " or not resources[resource][\"secret_scanning_used\"]",
      " or not resources[resource][\"least_privileged_access\"]",
      " or not resources[resource][\"least_privileged_network\"]"
    ]
  },
  "security_misconfig": {
    "name": "A05:2021 – Security Misconfiguration",
    "description": "OWASP top 10 #5: Review for security misconfigurations",
    "remediation": "Review non-compliant controls and remediate",
    "severity": 1,
    "likelihood": 1,
    "resource_scope": [
      "systems",
      "containers",
      "databases"
    ],
    "check_query": [
      " not resources[resource][\"is_hardened\"] ",
      " or not resources[resource][\"least_privileged_access\"]",
      " or not resources[resource][\"least_privileged_network\"]",
      " or not resources[resource][\"default_accounts_enabled\"]",
      " or not resources[resource][\"secure_logging_enabled\"]",
      " or not resources[resource][\"automatic_updates\"]"
    ]
  },
  "vulnerable_components": {
    "name": "A06:2021 – Vulnerable and Outdated Components",
    "description": "OWASP top 10 #6: Review for outdated or insecure dependencies",
    "remediation": "Review non-compliant controls and remediate",
    "severity": 1,
    "likelihood": 1,
    "resource_scope": [
      "systems",
      "containers"
    ],
    "check_query": [
      " not resources[resource][\"dependabot_used\"] ",
      " or not resources[resource][\"automatic_updates\"]",
      " or not resources[resource][\"security_scan_on_build\"]",
      " or not resources[resource][\"security_scan_on_artifact_storage\"]"
    ]
  }
}
